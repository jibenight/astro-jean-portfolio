---
import { Image } from 'astro:assets';
import Close from './Close.astro';
import phoneIcon from '../assets/images/phone-call.png';
import pinIcon from '../assets/images/pin.png';
import emailIcon from '../assets/images/email.png';
import smileIcon from '../assets/images/smile-64.png';
import avatarPortrait from '../assets/images/jean-portrait.jpg';
---

<section id='contact' class='contact-section'>
  <Close onClick="closeSection('contact')" />
  <div class='container-title'>
    <div class='title'>
      <h2>Me contacter</h2>
      <p>Hire me</p>
    </div>
  </div>

  <div class='contact-grid'>
    <div class='contact-info reveal-left'>
      <div class='info-header'>
        <div class='avatar'>
          <Image
            src={avatarPortrait}
            alt='Portrait de Jean Nguyen'
            width={72}
            height={72}
            class='avatar-img'
          />
        </div>
        <div>
          <p class='eyebrow'>
            Front-end Astro/Tailwind — IA (Claude/ChatGPT/Gemini)
          </p>
          <h3>Discutons perfs et delivery</h3>
          <p>
            Partage ton besoin front : je reviens sous 48h avec un plan court et
            actionnable (perfs, a11y, livraison).
          </p>
        </div>
      </div>

      <div class='badges'>
        <span>Freelance front-end</span>
        <span>Remote — Avignon</span>
        <span>FR / EN</span>
      </div>

      <div class='contact-cards'>
        <a href='mailto:message@jean-nguyen.dev' class='contact-card'>
          <div class='icon'>
            <Image src={emailIcon} alt='Email' width={32} height={32} />
          </div>
          <div>
            <p>Email</p>
            <strong>message@jean-nguyen.dev</strong>
          </div>
        </a>
        <a href='tel:(+33) 06 11 45 18 56' class='contact-card'>
          <div class='icon'>
            <Image src={phoneIcon} alt='Téléphone' width={32} height={32} />
          </div>
          <div>
            <p>Téléphone / WhatsApp</p>
            <strong>(+33) 06 11 45 18 56</strong>
          </div>
        </a>
        <div class='contact-card'>
          <div class='icon'>
            <Image src={pinIcon} alt='Localisation' width={32} height={32} />
          </div>
          <div>
            <p>Basé à</p>
            <strong>Avignon, France</strong>
          </div>
        </div>
      </div>

      <div class='availability-card'>
        <p>Besoin d’un retour rapide ? Un mail ou un call, et on démarre.</p>
      </div>
    </div>

    <div class='contact-form reveal-right'>
      <h3>Pitch ton projet</h3>
      <p>2–3 phrases suffisent pour lancer l’échange.</p>

      <form>
        <div class='form-grid'>
          <label>
            Nom complet
            <input type='text' name='name' placeholder='Votre nom' required />
          </label>
          <label>
            Email
            <input
              type='email'
              name='email'
              placeholder='vous@email.com'
              required
            />
          </label>
          <label>
            Type de projet
            <select name='project-type' required>
              <option value=''>Sélectionnez</option>
              <option>Site vitrine</option>
              <option>E-commerce</option>
              <option>Refonte</option>
              <option>Application web</option>
            </select>
          </label>
          <label class='full-width'>
            Message
            <textarea
              name='message'
              rows='4'
              placeholder='Décrivez brièvement votre projet'
              required></textarea>
          </label>
        </div>

        <button type='submit' class='btn-submit'>
          <Image src={smileIcon} alt='emoji sourire' width={32} height={32} />
          Envoyer le message
        </button>

        <p class='disclaimer'>
          En cliquant sur envoyer, vous acceptez que vos informations soient
          utilisées uniquement pour vous répondre.
        </p>
      </form>
    </div>
  </div>
  <div class='legal-link'>
    <a href='/mentions-legales'>Mentions légales</a>
  </div>
</section>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const revealBlocks = document.querySelectorAll(
      '.reveal-left, .reveal-right'
    );

    const observer = new IntersectionObserver(
      entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('in-view');
            observer.unobserve(entry.target);
          }
        });
      },
      { threshold: 0.3 }
    );
    revealBlocks.forEach(block => observer.observe(block));
  });
</script>

<style>
  #contact {
    position: fixed;
    inset: 0;
    overflow-y: auto;
    padding: 2rem clamp(1rem, 4vw, 5rem);
    background: #f4f6fb;
  }

  #contact p {
    line-height: 1.4;
  }

  .contact-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .contact-info {
    position: relative;
    background: linear-gradient(180deg, #0b7acb, #1da5fe);
    color: #f8fbff;
    border-radius: 32px;
    padding: 2.2rem;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    box-shadow: 0 30px 60px rgba(13, 138, 232, 0.32);
    overflow: hidden;
  }

  .contact-info::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
      circle at 20% 20%,
      rgba(255, 255, 255, 0.24),
      transparent 50%
    );
    pointer-events: none;
  }

  .info-header {
    display: flex;
    gap: 1.5rem;
    align-items: center;
  }

  .avatar {
    width: clamp(64px, 14vw, 72px);
    aspect-ratio: 1 / 1;
    flex-shrink: 0;
    border-radius: 50%;
    overflow: hidden;
    border: 3px solid rgba(255, 255, 255, 0.65);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
    background: rgba(255, 255, 255, 0.08);
  }

  .avatar-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
    border-radius: 50%;
  }

  .eyebrow {
    text-transform: uppercase;
    letter-spacing: 0.2rem;
    font-size: 0.85rem;
    opacity: 0.92;
    margin: 0;
  }

  .badges {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .badges span {
    padding: 0.3rem 0.8rem;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.18);
    font-size: 0.85rem;
    color: #f8fbff;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .contact-cards {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .contact-card {
    display: flex;
    gap: 1rem;
    padding: 1rem;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.16);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #f9fbff;
    text-decoration: none;
    transition:
      transform 0.3s ease,
      background 0.3s ease;
  }

  .contact-card:hover {
    transform: translateX(6px);
    background: rgba(255, 255, 255, 0.24);
  }

  .contact-card .icon {
    width: 64px;
    height: 64px;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(13, 138, 232, 0.18);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.22);
  }

  .contact-card .icon img {
    width: 48px;
    height: 48px;
    object-fit: contain;
    filter: drop-shadow(0 1px 4px rgba(13, 18, 28, 0.18));
  }

  .contact-card p {
    line-height: 0.1 !important;
  }

  .availability-card {
    background: rgba(255, 255, 255, 0.14);
    border-radius: 24px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.26);
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
    color: #f8fbff;
    box-shadow: 0 20px 36px rgba(0, 0, 0, 0.18);
  }

  .availability-header {
    display: flex;
    gap: 1rem;
    align-items: center;
  }

  .availability-header img {
    background: rgba(255, 255, 255, 0.96);
    border-radius: 14px;
    padding: 6px;
    border: 1px solid rgba(13, 138, 232, 0.2);
    box-shadow: 0 10px 22px rgba(0, 0, 0, 0.18);
  }

  .btn-light {
    background: #fff;
    color: #0d8ae8;
    padding: 0.7rem 1.4rem;
    border-radius: 999px;
    font-weight: 600;
    text-align: center;
    display: inline-flex;
    justify-content: center;
    text-decoration: none;
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
  }

  .contact-info h3,
  .contact-info p,
  .contact-info strong {
    color: #f8fbff;
  }

  .contact-form {
    background: linear-gradient(180deg, #ffffff 0%, #f9fbff 100%);
    border: 1px solid #e5eaf5;
    border-radius: 32px;
    padding: 2.2rem;
    box-shadow: 0 28px 60px rgba(0, 0, 0, 0.08);
    color: #0f172a;
    line-height: 1.4;
  }

  .contact-form h3 {
    margin: 0;
    font-size: 1.5rem;
  }

  .contact-form p {
    color: #556070;
  }

  form {
    margin-top: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }

  label {
    font-weight: 700;
    font-size: 0.95rem;
    display: flex;
    flex-direction: column;
    gap: 0.55rem;
    color: #111827;
  }

  input,
  select,
  textarea {
    border: 1px solid #d6deed;
    border-radius: 14px;
    padding: 0.85rem 1rem;
    font-size: 0.97rem;
    font-family: inherit;
    resize: none;
    background: #f8fafc;
    color: #0f172a;
    transition:
      border-color 0.2s ease,
      box-shadow 0.2s ease,
      background 0.2s ease;
  }

  input::placeholder,
  textarea::placeholder {
    color: #8a94a4;
  }

  input:focus,
  select:focus,
  textarea:focus {
    outline: none;
    border-color: #0d8ae8;
    box-shadow: 0 0 0 3px rgba(13, 138, 232, 0.18);
    background: #fff;
  }

  .full-width {
    grid-column: 1 / -1;
  }

  .btn-submit {
    margin-top: 0.5rem;
    background: linear-gradient(120deg, #0d8ae8, #1da5fe);
    color: #fff;
    border: none;
    border-radius: 14px;
    padding: 0.9rem 1.2rem;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    display: inline-flex;
    gap: 0.5rem;
    align-items: center;
    justify-content: center;
    box-shadow: 0 18px 35px rgba(13, 138, 232, 0.25);
  }

  .disclaimer {
    font-size: 0.75rem;
    color: #7b7b7b;
    margin: 0;
  }

  .disclaimer a {
    color: #0d8ae8;
  }

  .legal-link {
    margin-top: 1rem;
    text-align: center;
  }

  .legal-link a {
    color: #0d8ae8;
    font-weight: 600;
    text-decoration: none;
  }

  .legal-link a:hover {
    text-decoration: underline;
  }

  .btn-submit img {
    width: 32px;
    height: 32px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 50%;
    padding: 6px;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.16);
  }

  .reveal-left,
  .reveal-right {
    opacity: 0;
    transform: translateX(-40px);
    transition:
      opacity 0.6s ease,
      transform 0.6s ease;
  }

  .reveal-right {
    transform: translateX(40px);
  }

  .reveal-left.in-view,
  .reveal-right.in-view {
    opacity: 1;
    transform: translateX(0);
  }

  @media (max-width: 768px) {
    .contact-info,
    .contact-form {
      padding: 1.5rem;
    }

    .contact-card {
      flex-wrap: wrap;
    }
  }
</style>
